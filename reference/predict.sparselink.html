<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Out-of-sample Predictions — predict.sparselink • sparselink</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Out-of-sample Predictions — predict.sparselink"><meta name="description" content="Predicts outcomes with a multi-task or transfer learning regression model."><meta property="og:description" content="Predicts outcomes with a multi-task or transfer learning regression model."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sparselink</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">functions</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/article.html">article</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/analysis.html">analysis</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">news</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rauschenberger/sparselink/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Out-of-sample Predictions</h1>
      <small class="dont-index">Source: <a href="https://github.com/rauschenberger/sparselink/blob/main/R/functions.R" class="external-link"><code>R/functions.R</code></a></small>
      <div class="d-none name"><code>predict.sparselink.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Predicts outcomes with a multi-task or transfer learning regression model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'sparselink'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">newx</span>, weight <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>object of class <code>"sparselink"</code>
(generated by function <a href="sparselink.html">sparselink</a>)</p></dd>


<dt id="arg-newx">newx<a class="anchor" aria-label="anchor" href="#arg-newx"></a></dt>
<dd><p>features:
matrix with \(n\) rows (samples) and \(p\) columns (variables)
for multi-task learning;
list of \(q\) matrices
with \(n_k\) rows (samples) and \(p\) columns (variables)
for transfer learning, for each \(k\) in \(1,\ldots,q\)</p></dd>


<dt id="arg-weight">weight<a class="anchor" aria-label="anchor" href="#arg-weight"></a></dt>
<dd><p>hyperparameters for scaling external and internal weights:
numeric vector of length 2,
with the first entry for the external weights
(prior coefficients from source data),
and the second entry for the internal weights
(prior coefficients from target data),
selected values must be among the candidate values,
default: <code>NULL</code> (using cross-validated weights)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>(not applicable)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns predicted values or predicted probabilities.
The output is a list of \(q\) column vectors of length \(n_k\)
for \(k\) in \(1,\ldots,q\).
Each vector corresponds to one target (multi-task learning)
or one dataset (transfer learning).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p><a href="https://orcid.org/0000-0001-6498-4801" class="external-link">Armin Rauschenberger</a>,
<a href="https://orcid.org/0000-0003-3443-0298" class="external-link">Petr N. Nazarov</a>, and
<a href="https://orcid.org/0000-0003-3977-7469" class="external-link">Enrico Glaab</a>
(2025).
"Estimating sparse regression models in multi-task learning and transfer learning through adaptive penalisation".
<em>Under revision</em>. <a href="https://hdl.handle.net/10993/63425" class="external-link">https://hdl.handle.net/10993/63425</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Use <code><a href="sparselink.html">sparselink</a></code> to fit the model
and <code><a href="coef.sparselink.html">coef</a></code> to extract coefficients.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">family</span> <span class="op">&lt;-</span> <span class="st">"gaussian"</span></span></span>
<span class="r-in"><span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"multiple"</span> <span class="co"># try "multiple" or "transfer"</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="va">type</span><span class="op">==</span><span class="st">"multiple"</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span> <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim_data_multi.html">sim_data_multi</a></span><span class="op">(</span>family<span class="op">=</span><span class="va">family</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">type</span><span class="op">==</span><span class="st">"transfer"</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span> <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim_data_multi.html">sim_data_trans</a></span><span class="op">(</span>family<span class="op">=</span><span class="va">family</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="sparselink.html">sparselink</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">X_train</span>,y<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">y_train</span>,family<span class="op">=</span><span class="va">family</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> mode: multi-target learning, alpha.init=0.95 (elastic net), alpha=1 (lasso)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold</span>
<span class="r-in"><span><span class="va">y_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>object<span class="op">=</span><span class="va">object</span>,newx<span class="op">=</span><span class="va">data</span><span class="op">$</span><span class="va">X_test</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Armin Rauschenberger.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

